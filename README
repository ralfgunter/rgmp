This is VERY far from done, please handle with care.

It compiles, but is almost certainly very unoptimized and does not check a lot of nasty errors yet!
